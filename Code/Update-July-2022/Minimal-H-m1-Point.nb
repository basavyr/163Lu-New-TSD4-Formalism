(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15354,        415]
NotebookOptionsPosition[     14365,        391]
NotebookOutlinePosition[     14763,        407]
CellTagsIndexPosition[     14720,        404]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.866322156073097*^9, 3.866322160518888*^9}},
 CellLabel->
  "In[489]:=",ExpressionUUID->"799a29ce-7879-4d90-84ee-1e1eff88df9b"],

Cell[CellGroupData[{

Cell["Numerical implementation", "Subsection",
 CellChangeTimes->{{3.8661632934598713`*^9, 
  3.866163302963512*^9}},ExpressionUUID->"3fe290ac-f797-42a0-b0a9-\
6016b2562fd3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tcore", "[", 
    RowBox[{"I_", ",", "A1_", ",", "A2_", ",", "A3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["I", "2"], 
     RowBox[{"(", 
      RowBox[{"A1", "+", "A2"}], ")"}]}], "+", 
    RowBox[{"A3", "*", 
     SuperscriptBox["I", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tsp", "[", 
    RowBox[{"j_", ",", "A1_", ",", "A2_", ",", "A3_", ",", "V_", ",", "gm_"}],
     "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["j", "2"], 
     RowBox[{"(", 
      RowBox[{"A2", "+", "A3"}], ")"}]}], "+", 
    RowBox[{"A1", "*", 
     SuperscriptBox["j", "2"]}], "-", 
    RowBox[{"V", "*", 
     FractionBox[
      RowBox[{
       RowBox[{"2", "j"}], "-", "1"}], 
      RowBox[{"j", "+", "1"}]], 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"gm", "*", 
        FractionBox["\[Pi]", "180"]}], "+", 
       FractionBox["\[Pi]", "6"]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Aphi", "[", 
    RowBox[{"phi_", ",", "A1_", ",", "A2_", ",", "A3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"A1", "*", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "phi", "]"}], "2"]}], "+", 
    RowBox[{"A2", "*", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "phi", "]"}], "2"]}], "-", "A3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hmin", "[", 
    RowBox[{
    "theta_", ",", "phi_", ",", "I_", ",", "j_", ",", "A1_", ",", "A2_", ",", 
     "A3_", ",", "V_", ",", "gm_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"I", 
     RowBox[{"(", 
      RowBox[{"I", "-", 
       FractionBox["1", "2"]}], ")"}], 
     SuperscriptBox[
      RowBox[{"Sin", "[", "theta", "]"}], "2"], "*", 
     RowBox[{"Aphi", "[", 
      RowBox[{"phi", ",", "A1", ",", "A2", ",", "A3"}], "]"}]}], "-", 
    RowBox[{"2", "*", "A1", "*", "I", "*", "j", "*", 
     RowBox[{"Sin", "[", "theta", "]"}]}], "+", 
    RowBox[{"Tcore", "[", 
     RowBox[{"I", ",", "A1", ",", "A2", ",", "A3"}], "]"}], "+", 
    RowBox[{"Tsp", "[", 
     RowBox[{"j", ",", "A1", ",", "A2", ",", "A3", ",", "V", ",", "gm"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ak", "[", "moi_", "]"}], ":=", 
   FractionBox["1", 
    RowBox[{"2", "*", "moi"}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.866156225810783*^9, 3.866156358387226*^9}, {
   3.866156456713018*^9, 3.8661565389189997`*^9}, {3.866156576899577*^9, 
   3.866156638266711*^9}, {3.866157940240129*^9, 3.866157953187599*^9}, 
   3.86616026531056*^9},
 CellLabel->
  "In[490]:=",ExpressionUUID->"ab054b1b-0906-4753-9135-68c60a03f389"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"I1fit", "=", "72"}], ";", 
  RowBox[{"I2fit", "=", "15"}], ";", 
  RowBox[{"I3fit", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vfit", "=", "2.1"}], ";", 
  RowBox[{"gmfit", "=", "22"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j1", "=", 
   RowBox[{"13", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A1fit", "=", 
   RowBox[{"Ak", "[", "I1fit", "]"}]}], ";", 
  RowBox[{"A2fit", "=", 
   RowBox[{"Ak", "[", "I2fit", "]"}]}], ";", 
  RowBox[{"A3fit", "=", 
   RowBox[{"Ak", "[", "I3fit", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hpolar", "[", 
    RowBox[{"theta_", ",", "phi_", ",", "I_"}], "]"}], ":=", 
   RowBox[{"Hmin", "[", 
    RowBox[{
    "theta", ",", "phi", ",", "I", ",", "j1", ",", "A1fit", ",", "A2fit", ",",
      "A3fit", ",", "Vfit", ",", "gmfit"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Pi]", "/", "2"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hminimal", "[", "I_", "]"}], ":=", 
   RowBox[{"Hpolar", "[", 
    RowBox[{
     RowBox[{"m2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"m2", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "I"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.866157881437591*^9, 3.86615800994453*^9}, {
  3.8661581276960793`*^9, 3.866158155667864*^9}, {3.866322067657422*^9, 
  3.8663220781140423`*^9}, {3.866322124069035*^9, 3.866322152035634*^9}},
 CellLabel->
  "In[495]:=",ExpressionUUID->"0a46a26c-3ae6-4cd8-99a2-42f142d6902c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"imageFeatures", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "0.8"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "380"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "Black", "]"}]}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"17", ",", 
        RowBox[{"FontFamily", "->", "\"\<Latin Modern Roman\>\""}], ",", 
        "Black"}], "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texStyle", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FontFamily", "\[Rule]", "\"\<Latin Modern Roman\>\""}], ",", 
     "Black", ",", "17"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8663224316248627`*^9, 3.8663224622665453`*^9}, {
  3.866322695999463*^9, 3.8663227014211063`*^9}},
 CellLabel->
  "In[502]:=",ExpressionUUID->"0f511966-56dd-4c98-843b-aa8c4cf4be8d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"figure", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", ",", 
         RowBox[{"Hminimal", "[", "s", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "6.5", ",", "32.5", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "0.8"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "380"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "Black", "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", " ", "Medium"}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Darker", "@", "Cyan"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<I [\[HBar]]\>\"", ",", "\"\<\[ScriptCapitalH] [MeV]\>\""}], 
       "}"}]}], ",", 
     RowBox[{"Evaluate", "[", "imageFeatures", "]"}], ",", 
     RowBox[{"Filling", "\[Rule]", "0"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gfx", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"{", 
     RowBox[{"figure", ",", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Black", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"40", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}], 
      ",", 
      RowBox[{"Graphics", "[", 
       RowBox[{"Inset", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          
          "\"\<\!\(\*SubscriptBox[\(m\), \(1\)]\)=( \!\(\*FractionBox[\(\[Pi]\
\), \(2\)]\) , 0 )\>\"", ",", 
           RowBox[{"Evaluate", "[", "texStyle", "]"}]}], "]"}], ",", 
         RowBox[{"Scaled", "[", 
          RowBox[{"{", 
           RowBox[{"0.3", ",", "0.7"}], "}"}], "]"}]}], "]"}], "]"}]}], "}"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "gfx", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\</Users/basavyr/Documents/Work/PhD/163Lu-New-TSD4-Formalism/Code/\
Update-July-2022/plots/H-minimal-m1.pdf\>\"", ",", 
    RowBox[{"Show", "[", "gfx", "]"}], ",", 
    RowBox[{"ImageResolution", "->", "1200"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.866322195304467*^9, 3.8663223901658697`*^9}, {
  3.866322453296307*^9, 3.866322732224122*^9}, {3.866322770590225*^9, 
  3.866322787484459*^9}, {3.866322832047681*^9, 3.8663228686134872`*^9}, {
  3.866322905501265*^9, 3.866322910695314*^9}, {3.866322957453436*^9, 
  3.866323017693038*^9}},
 CellLabel->
  "In[504]:=",ExpressionUUID->"6009307b-bccb-454d-958a-f0ac334b3fce"],

Cell[BoxData[
 GraphicsBox[{{{}, {{
      {RGBColor[0, 
        NCache[
         Rational[2, 3], 0.6666666666666666], 
        NCache[
         Rational[2, 3], 0.6666666666666666]], Opacity[0.2], EdgeForm[None], 
       GraphicsGroupBox[
        PolygonBox[{{19.951864826130915`, 0.}, {6.5, 0.}, {
         6.5, -1.966763751166205}, {8.5, -1.834224068626522}, {
         10.5, -1.6461288305312847`}, {12.5, -1.4024780368804937`}, {
         14.5, -1.1032716876741446`}, {16.5, -0.7485097829122402}, {
         18.5, -0.33819232259478227`}}]]}, 
      {RGBColor[0, 
        NCache[
         Rational[2, 3], 0.6666666666666666], 
        NCache[
         Rational[2, 3], 0.6666666666666666]], Opacity[0.2], EdgeForm[None], 
       GraphicsGroupBox[
        PolygonBox[{{19.951864826130915`, 0.}, {32.5, 0.}, {32.5, 
         4.089585455182984}, {30.5, 3.2903791059766405`}, {28.5, 
         2.546728312325854}, {26.5, 1.8586330742306174`}, {24.5, 
         1.226093391690931}, {22.5, 0.6491092647068086}, {20.5, 
         0.1276806932782364}}]]}, {}, {}}, {{}, {}, 
      {RGBColor[0, 
        NCache[
         Rational[2, 3], 0.6666666666666666], 
        NCache[
         Rational[2, 3], 0.6666666666666666]], PointSize[
       0.012833333333333334`], AbsoluteThickness[1.6], 
       LineBox[{{6.5, -1.966763751166205}, {8.5, -1.834224068626522}, {
        10.5, -1.6461288305312847`}, {12.5, -1.4024780368804937`}, {
        14.5, -1.1032716876741446`}, {16.5, -0.7485097829122402}, {
        18.5, -0.33819232259478227`}, {19.951864826130915`, 0.}, {20.5, 
        0.1276806932782364}, {22.5, 0.6491092647068086}, {24.5, 
        1.226093391690931}, {26.5, 1.8586330742306174`}, {28.5, 
        2.546728312325854}, {30.5, 3.2903791059766405`}, {32.5, 
        4.089585455182984}}]}}, 
     {RGBColor[0, 
       NCache[
        Rational[2, 3], 0.6666666666666666], 
       NCache[
        Rational[2, 3], 0.6666666666666666]], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      GeometricTransformationBox[InsetBox[
        FormBox[
         StyleBox[
          GraphicsBox[
           {EdgeForm[None], DiskBox[{0, 0}]}],
          StripOnInput->False,
          GraphicsBoxOptions->{DefaultBaseStyle->Directive[
            PointSize[0.012833333333333334`], 
            AbsoluteThickness[1.6], 
            RGBColor[0, 
             Rational[2, 3], 
             Rational[2, 3]]]}],
         TraditionalForm], {0., 0.}, Automatic, Offset[10]], {{{
       6.5, -1.966763751166205}}, {{8.5, -1.834224068626522}}, {{
       10.5, -1.6461288305312847`}}, {{12.5, -1.4024780368804937`}}, {{
       14.5, -1.1032716876741446`}}, {{16.5, -0.7485097829122402}}, {{
       18.5, -0.33819232259478227`}}, {{20.5, 0.1276806932782364}}, {{22.5, 
       0.6491092647068086}}, {{24.5, 1.226093391690931}}, {{26.5, 
       1.8586330742306174`}}, {{28.5, 2.546728312325854}}, {{30.5, 
       3.2903791059766405`}}, {{32.5, 4.089585455182984}}}]}}, {{}, {}}}, 
   {GrayLevel[0], LineBox[{{-1, 0}, {40, 0}}]}, InsetBox[
    StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(m\\), \\(1\\)]\\)=( \
\\!\\(\\*FractionBox[\\(\[Pi]\\), \\(2\\)]\\) , 0 )\"\>",
     StripOnInput->False,
     LineColor->GrayLevel[0],
     FrontFaceColor->GrayLevel[0],
     BackFaceColor->GrayLevel[0],
     GraphicsColor->GrayLevel[0],
     FontFamily->"Latin Modern Roman",
     FontSize->17,
     FontColor->GrayLevel[0]], Scaled[{0.3, 0.7}]]},
  AspectRatio->0.8,
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{5.958333333333347, 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox["\"\[ScriptCapitalH] [MeV]\"", TraditionalForm], None}, {
     FormBox["\"I [\[HBar]]\"", TraditionalForm], None}},
  FrameStyle->Directive[
    GrayLevel[0]],
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->380,
  LabelStyle->{17, FontFamily -> "Latin Modern Roman", 
    GrayLevel[0]},
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{5.958333333333347, 32.5}, {-1.966763751166205, 
   4.089585455182984}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.866322212460947*^9, 3.866322306381229*^9}, {
   3.866322353071287*^9, 3.866322390791974*^9}, {3.866322465224968*^9, 
   3.8663225705129147`*^9}, {3.866322651753985*^9, 3.866322732679264*^9}, 
   3.866322911201561*^9, 3.866322958182719*^9, 3.866323019334046*^9},
 CellLabel->
  "Out[506]=",ExpressionUUID->"378c24dc-eea5-4703-b893-a11133090ecd"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{115, Automatic}, {Automatic, 221}},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"df6e2a9e-f7e4-4aeb-9f8b-134491bdee17"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 225, 4, 30, "Input",ExpressionUUID->"799a29ce-7879-4d90-84ee-1e1eff88df9b"],
Cell[CellGroupData[{
Cell[808, 28, 174, 3, 54, "Subsection",ExpressionUUID->"3fe290ac-f797-42a0-b0a9-6016b2562fd3"],
Cell[985, 33, 2643, 78, 237, "Input",ExpressionUUID->"ab054b1b-0906-4753-9135-68c60a03f389"],
Cell[3631, 113, 1656, 46, 157, "Input",ExpressionUUID->"0a46a26c-3ae6-4cd8-99a2-42f142d6902c"],
Cell[5290, 161, 1018, 25, 94, "Input",ExpressionUUID->"0f511966-56dd-4c98-843b-aa8c4cf4be8d"],
Cell[CellGroupData[{
Cell[6333, 190, 3011, 77, 264, "Input",ExpressionUUID->"6009307b-bccb-454d-958a-f0ac334b3fce"],
Cell[9347, 269, 4990, 118, 337, "Output",ExpressionUUID->"378c24dc-eea5-4703-b893-a11133090ecd"]
}, Open  ]]
}, Open  ]]
}
]
*)

