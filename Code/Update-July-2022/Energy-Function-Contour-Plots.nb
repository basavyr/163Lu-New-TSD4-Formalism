(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16183,        410]
NotebookOptionsPosition[     15159,        384]
NotebookOutlinePosition[     15558,        400]
CellTagsIndexPosition[     15515,        397]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Energy Function - Contour Plots", "Section",
 CellChangeTimes->{{3.866156164450582*^9, 
  3.866156171118464*^9}},ExpressionUUID->"cc1cabae-6066-40d6-962f-\
662a2ba7fc0b"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.866156306153466*^9, 3.866156310914815*^9}},
 CellLabel->
  "In[5644]:=",ExpressionUUID->"fa907f6a-21ce-4cb4-86ae-9a44a6a217da"],

Cell[CellGroupData[{

Cell["Numerical implementation", "Subsection",
 CellChangeTimes->{{3.8661632934598713`*^9, 
  3.866163302963512*^9}},ExpressionUUID->"1ce817a4-f366-4356-977e-\
71404799d8e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tcore", "[", 
    RowBox[{"I_", ",", "A1_", ",", "A2_", ",", "A3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["I", "2"], 
     RowBox[{"(", 
      RowBox[{"A1", "+", "A2"}], ")"}]}], "+", 
    RowBox[{"A3", "*", 
     SuperscriptBox["I", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tsp", "[", 
    RowBox[{"j_", ",", "A1_", ",", "A2_", ",", "A3_", ",", "V_", ",", "gm_"}],
     "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["j", "2"], 
     RowBox[{"(", 
      RowBox[{"A2", "+", "A3"}], ")"}]}], "+", 
    RowBox[{"A1", "*", 
     SuperscriptBox["j", "2"]}], "-", 
    RowBox[{"V", "*", 
     FractionBox[
      RowBox[{
       RowBox[{"2", "j"}], "-", "1"}], 
      RowBox[{"j", "+", "1"}]], 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"gm", "*", 
        FractionBox["\[Pi]", "180"]}], "+", 
       FractionBox["\[Pi]", "6"]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Aphi", "[", 
    RowBox[{"phi_", ",", "A1_", ",", "A2_", ",", "A3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"A1", "*", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "phi", "]"}], "2"]}], "+", 
    RowBox[{"A2", "*", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "phi", "]"}], "2"]}], "-", "A3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hmin", "[", 
    RowBox[{
    "theta_", ",", "phi_", ",", "I_", ",", "j_", ",", "A1_", ",", "A2_", ",", 
     "A3_", ",", "V_", ",", "gm_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"I", 
     RowBox[{"(", 
      RowBox[{"I", "-", 
       FractionBox["1", "2"]}], ")"}], 
     SuperscriptBox[
      RowBox[{"Sin", "[", "theta", "]"}], "2"], "*", 
     RowBox[{"Aphi", "[", 
      RowBox[{"phi", ",", "A1", ",", "A2", ",", "A3"}], "]"}]}], "-", 
    RowBox[{"2", "*", "A1", "*", "I", "*", "j", "*", 
     RowBox[{"Sin", "[", "theta", "]"}]}], "+", 
    RowBox[{"Tcore", "[", 
     RowBox[{"I", ",", "A1", ",", "A2", ",", "A3"}], "]"}], "+", 
    RowBox[{"Tsp", "[", 
     RowBox[{"j", ",", "A1", ",", "A2", ",", "A3", ",", "V", ",", "gm"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ak", "[", "moi_", "]"}], ":=", 
   FractionBox["1", 
    RowBox[{"2", "*", "moi"}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.866156225810783*^9, 3.866156358387226*^9}, {
   3.866156456713018*^9, 3.8661565389189997`*^9}, {3.866156576899577*^9, 
   3.866156638266711*^9}, {3.866157940240129*^9, 3.866157953187599*^9}, 
   3.86616026531056*^9},
 CellLabel->
  "In[5645]:=",ExpressionUUID->"c2edfa71-dbd2-4dba-b840-1aeb2275d0e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"I1fit", "=", "72"}], ";", 
  RowBox[{"I2fit", "=", "15"}], ";", 
  RowBox[{"I3fit", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vfit", "=", "2.1"}], ";", 
  RowBox[{"gmfit", "=", "22"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j1", "=", 
   RowBox[{"13", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A1fit", "=", 
   RowBox[{"Ak", "[", "I1fit", "]"}]}], ";", 
  RowBox[{"A2fit", "=", 
   RowBox[{"Ak", "[", "I2fit", "]"}]}], ";", 
  RowBox[{"A3fit", "=", 
   RowBox[{"Ak", "[", "I3fit", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hpolar", "[", 
    RowBox[{"theta_", ",", "phi_", ",", "I_"}], "]"}], ":=", 
   RowBox[{"Hmin", "[", 
    RowBox[{
    "theta", ",", "phi", ",", "I", ",", "j1", ",", "A1fit", ",", "A2fit", ",",
      "A3fit", ",", "Vfit", ",", "gmfit"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.866157881437591*^9, 3.86615800994453*^9}, {
  3.8661581276960793`*^9, 3.866158155667864*^9}},
 CellLabel->
  "In[5650]:=",ExpressionUUID->"4ea85b0c-5894-4543-8070-827f83911fee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Contour plots", "Subsection",
 CellChangeTimes->{{3.866158201625351*^9, 
  3.866158203570773*^9}},ExpressionUUID->"bb056804-d660-4eda-97ff-\
febe27544759"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Set", " ", "style", " ", "for", " ", "range", " ", "of", " ", 
    "contours"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"source", ":", " ", "https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "28762"}], "/", "contourstyle"}], "-", "for", "-",
      "a", "-", "particular", "-", "contour", "-", "line", "-", "in", "-", 
     "contourplot"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"Contours", "->", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", ">=", "2.5"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Dashed", ",", "Black"}], "]"}], ",", 
           RowBox[{"Directive", "[", "Black", "]"}]}], " ", "]"}]}], "}"}], 
       "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"-", "100"}], ",", "100", ",", "0.65"}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"contourStyiling", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImageSize", "\[Rule]", "380"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", "Black", "]"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "1.15"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"texStyle", "[", "fontsize_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "->", "\"\<Latin Modern Roman\>\""}], ",", 
       RowBox[{"FontSize", "->", "fontsize"}], ",", "Black"}], "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cpColor", "=", "\"\<StarryNightColors\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cp", "[", 
      RowBox[{"I_", ",", "color_"}], "]"}], ":=", 
     RowBox[{"ContourPlot", "[", 
      RowBox[{
       RowBox[{"Hpolar", "[", 
        RowBox[{"\[Theta]", ",", "\[CurlyPhi]", ",", "I"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[CurlyPhi]", ",", 
         RowBox[{"-", "0.11"}], ",", 
         RowBox[{
          RowBox[{"2", "\[Pi]"}], "+", "0.11"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", "contourStyiling", "]"}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", "color"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"BarLegend", "[", 
           RowBox[{"Automatic", ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "6"}], "}"}], ",", 
            RowBox[{"LegendMargins", "\[Rule]", "0"}], ",", 
            RowBox[{"LegendMarkerSize", "\[Rule]", "250"}], ",", 
            RowBox[{"LabelStyle", "->", 
             RowBox[{"texStyle", "[", "17", "]"}]}], ",", 
            RowBox[{"LegendLabel", "\[Rule]", 
             RowBox[{"Placed", "[", 
              RowBox[{
              "\"\<\[ScriptCapitalH](\[Theta],\[CurlyPhi])\\n[MeV]\>\"", ",", 
               "Top"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"After", ",", "Center"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"Contours", "\[Rule]", "14"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
       RowBox[{"ImageMargins", "\[Rule]", "0"}], ",", 
       RowBox[{"FrameTicksStyle", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FontOpacity", "->", "0"}], ",", 
              RowBox[{"FontSize", "->", "0"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FontOpacity", "->", "0"}], ",", 
              RowBox[{"FontSize", "->", "0"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FontOpacity", "->", "0"}], ",", 
              RowBox[{"FontSize", "->", "0"}]}], "}"}]}], "}"}]}], "}"}]}], 
       ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"texStyle", "[", "17", "]"}]}], ",", 
       RowBox[{"ImagePadding", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"37", ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"37", ",", " ", "0"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangeClipping", "->", "False"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"finalPlot", "[", "I_", "]"}], ":=", 
     RowBox[{"Show", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cp", "[", 
         RowBox[{"I", ",", "cpColor"}], "]"}], ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"#", ",", 
                RowBox[{"texStyle", "[", "17", "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"-", "0.33"}]}], "}"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "3", ",", "1"}], "}"}]}], "]"}]}], 
          "}"}], "]"}], ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\[Theta] [rad]\>\"", ",", 
              RowBox[{"texStyle", "[", "17", "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Pi]", "/", "2"}], ",", 
              RowBox[{"-", "0.6"}]}], "}"}]}], "]"}], "}"}], "]"}], ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Rotate", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<\[CurlyPhi] [rad]\>\"", ",", 
                RowBox[{"texStyle", "[", "17", "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.33"}], ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
            RowBox[{"90", "Degree"}]}], "]"}], "}"}], "]"}]}], "}"}], "]"}]}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.866158205224778*^9, 3.866158508776924*^9}, {
   3.86615854413302*^9, 3.8661585544851713`*^9}, {3.866158779631487*^9, 
   3.866158783106372*^9}, {3.8661590799434853`*^9, 3.8661592084253817`*^9}, {
   3.8661592429094667`*^9, 3.8661592644508467`*^9}, {3.866159309930159*^9, 
   3.866159311725348*^9}, {3.866159343059882*^9, 3.866159364091284*^9}, {
   3.866159400186886*^9, 3.866159444664549*^9}, {3.866159598322277*^9, 
   3.866159647981599*^9}, {3.866160223712749*^9, 3.866160236986806*^9}, {
   3.8661602953002*^9, 3.86616030106842*^9}, {3.8661604123176737`*^9, 
   3.866160472764944*^9}, {3.866160517201791*^9, 3.866160554900125*^9}, 
   3.8661606055603313`*^9, {3.8661610412954597`*^9, 3.866161105696661*^9}, {
   3.866161585933332*^9, 3.866161589013863*^9}, {3.8661616761463127`*^9, 
   3.86616179190969*^9}, {3.866161850384701*^9, 3.866161867496986*^9}, {
   3.866162159944768*^9, 3.86616217011943*^9}, {3.866162200793728*^9, 
   3.866162219095611*^9}, {3.866162490310071*^9, 3.866162501956683*^9}, {
   3.866162692376305*^9, 3.866162816066004*^9}, {3.8661628776026573`*^9, 
   3.866163083659401*^9}, {3.866163249776423*^9, 3.86616328417587*^9}, {
   3.866163448753872*^9, 3.866163458486455*^9}, {3.8661634892632713`*^9, 
   3.866163565946509*^9}, {3.866165725654108*^9, 3.866165726744453*^9}, {
   3.866166009353993*^9, 3.866166033071273*^9}, {3.866170346081851*^9, 
   3.8661703536748867`*^9}, {3.866170387415757*^9, 3.866170424866864*^9}, {
   3.866170646149026*^9, 3.8661706556570263`*^9}, {3.86617091377811*^9, 
   3.866170940998601*^9}, 3.866171014991432*^9, {3.866171047661153*^9, 
   3.866171183084453*^9}, {3.866171295877836*^9, 3.866171441608025*^9}, {
   3.86617149998396*^9, 3.866171708839031*^9}, {3.866172027168494*^9, 
   3.866172043260285*^9}, {3.866187838228895*^9, 3.8661878932193327`*^9}, {
   3.866187926463578*^9, 3.866188035483388*^9}, {3.866188085835402*^9, 
   3.8661880859780807`*^9}, {3.866188178356925*^9, 3.866188186735303*^9}, {
   3.866244636081218*^9, 3.866244662110387*^9}, {3.866244692183907*^9, 
   3.866244721952796*^9}, {3.86624502562988*^9, 3.866245086567902*^9}, {
   3.866245120836075*^9, 3.866245137559084*^9}, {3.866245168739649*^9, 
   3.8662452446611834`*^9}, 3.8662453182155333`*^9, {3.866245378272739*^9, 
   3.86624539905917*^9}, {3.866245437873165*^9, 3.8662454556151953`*^9}, {
   3.866245515545444*^9, 3.866245705060869*^9}, {3.8662458703127193`*^9, 
   3.866245951134191*^9}, {3.866246010183172*^9, 3.86624604485087*^9}, {
   3.8662460833178663`*^9, 3.866246123192954*^9}, {3.866246200445772*^9, 
   3.866246225740512*^9}, {3.866246513958078*^9, 3.866246530628931*^9}, {
   3.8662465687134666`*^9, 3.866246638842432*^9}, {3.866246685758971*^9, 
   3.866246771902841*^9}, {3.8662468574043837`*^9, 3.8662469082275887`*^9}, {
   3.866246946395788*^9, 3.866246947225708*^9}, {3.866246996518362*^9, 
   3.8662470534684677`*^9}, {3.866247095106284*^9, 3.8662471329740458`*^9}, {
   3.866247178092798*^9, 3.8662471832738867`*^9}, {3.8662472459266*^9, 
   3.866247270244576*^9}, {3.86624731497832*^9, 3.8662473657049026`*^9}, {
   3.86624741803106*^9, 3.866247627065155*^9}, {3.8662476913315773`*^9, 
   3.866248206789921*^9}},
 CellLabel->
  "In[5655]:=",ExpressionUUID->"ad60de4f-fe7d-43f5-9218-526ac21bd440"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1404, 931},
WindowMargins->{{418, Automatic}, {205, Automatic}},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"58f5a146-3e58-44ba-9f73-d2685780bf32"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 176, 3, 67, "Section",ExpressionUUID->"cc1cabae-6066-40d6-962f-662a2ba7fc0b"],
Cell[759, 27, 226, 4, 30, "Input",ExpressionUUID->"fa907f6a-21ce-4cb4-86ae-9a44a6a217da"],
Cell[CellGroupData[{
Cell[1010, 35, 174, 3, 54, "Subsection",ExpressionUUID->"1ce817a4-f366-4356-977e-71404799d8e3"],
Cell[1187, 40, 2644, 78, 216, "Input",ExpressionUUID->"c2edfa71-dbd2-4dba-b840-1aeb2275d0e0"],
Cell[3834, 120, 1113, 29, 115, "Input",ExpressionUUID->"4ea85b0c-5894-4543-8070-827f83911fee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4984, 154, 161, 3, 54, "Subsection",ExpressionUUID->"bb056804-d660-4eda-97ff-febe27544759"],
Cell[5148, 159, 9983, 221, 326, "Input",ExpressionUUID->"ad60de4f-fe7d-43f5-9218-526ac21bd440"]
}, Open  ]]
}, Open  ]]
}
]
*)

