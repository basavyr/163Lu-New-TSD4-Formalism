(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     42342,       1070]
NotebookOptionsPosition[     39528,       1007]
NotebookOutlinePosition[     39864,       1022]
CellTagsIndexPosition[     39821,       1019]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Lu163 - Energy Ellipsoid", "Chapter",
 CellChangeTimes->{{3.812677593933135*^9, 
  3.812677605902338*^9}},ExpressionUUID->"a6bfc515-495d-4114-8d0e-\
7b421182e749"],

Cell[CellGroupData[{

Cell["\<\
Graphical representation for the energy function H in a 3D space\
\>", "Section",
 CellChangeTimes->{{3.8126776090546207`*^9, 
  3.812677621878602*^9}},ExpressionUUID->"bf3c8d02-a663-405a-842a-\
00300e866e3c"],

Cell[CellGroupData[{

Cell["\<\
New formalism for the energy ellipsoid (given by the current expression of \
the energy function, expressed in terms of the spherical coordinates)\
\>", "Subsection",
 CellChangeTimes->{{3.812682553979457*^9, 3.812682610846623*^9}, {
  3.812682667650482*^9, 
  3.8126826678299026`*^9}},ExpressionUUID->"a38b2b5e-ff8f-407a-9bcf-\
5f30654c7777"],

Cell["Cartesian to spherical coordinate transformation is required", "Text",
 CellChangeTimes->{{3.812682669496163*^9, 
  3.8126826804748993`*^9}},ExpressionUUID->"df1d78de-f74e-4048-a41d-\
ad5d5aa8c130"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ellipsoid", "[", 
    RowBox[{"a1_", ",", "a2_", ",", "a3_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"ContourPlot3D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"a1", "*", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"a2", "*", 
        SuperscriptBox["y", "2"]}], "+", 
       RowBox[{"a3", "*", 
        SuperscriptBox["z", "2"]}]}], "\[Equal]", 
      RowBox[{"e", "*", 
       RowBox[{"(", 
        RowBox[{"e", "+", "1"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{
        RowBox[{"-", "1.2"}], "e"}], ",", 
       RowBox[{"1.2", "e"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        RowBox[{"-", "1.2"}], "e"}], ",", 
       RowBox[{"1.2", "e"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{
        RowBox[{"-", "1.2"}], "e"}], ",", 
       RowBox[{"1.2", "e"}]}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Orange", ",", 
        RowBox[{"Opacity", "[", "0.6", "]"}]}], "}"}]}], ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.812682682222055*^9, 3.812682726746977*^9}, {
   3.812683361527812*^9, 3.812683379708593*^9}, {3.812683414303111*^9, 
   3.812683420106924*^9}, {3.812683471096057*^9, 3.812683478338703*^9}, {
   3.812683788524683*^9, 3.812683847148312*^9}, {3.812684175728256*^9, 
   3.812684220052373*^9}, {3.8126843302059603`*^9, 3.8126843304179983`*^9}, {
   3.812685599062831*^9, 3.8126856037522507`*^9}, {3.812685641914835*^9, 
   3.81268565159857*^9}, 3.812685797270917*^9, {3.81269252826208*^9, 
   3.812692612188992*^9}, {3.812694674219544*^9, 3.812694677425454*^9}, {
   3.81269498961339*^9, 3.812694991275277*^9}, {3.812696008371922*^9, 
   3.812696069752627*^9}, {3.81269735865307*^9, 3.8126973637800283`*^9}, {
   3.81270028906101*^9, 3.812700297712633*^9}, {3.8127011379695663`*^9, 
   3.812701176987059*^9}, {3.812708351489023*^9, 3.812708426156576*^9}, {
   3.8127085074542017`*^9, 3.812708528973967*^9}, {3.812709995390506*^9, 
   3.812710006967379*^9}, {3.8127100400432053`*^9, 3.8127100426970587`*^9}, {
   3.812756294968574*^9, 3.812756296730818*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"cd3bbdfa-b67a-4c5a-b996-bbef0c5a510e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cartesian coordinates", "Section",
 CellChangeTimes->{{3.8145004804634457`*^9, 
  3.814500487957024*^9}},ExpressionUUID->"0d8adffc-e877-41d5-9c04-\
8dd308ab21cf"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "1"], "=", 
    RowBox[{"I", " ", "sin\[Theta]", " ", "cos\[CurlyPhi]"}]}], 
   TraditionalForm]],ExpressionUUID->"ebc3470c-8eed-4c1f-95a5-849d94845683"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "2"], "=", 
    RowBox[{"I", " ", "sin\[Theta]", " ", "sin\[CurlyPhi]"}]}], 
   TraditionalForm]],ExpressionUUID->"959fa2d8-5764-4d00-8c2d-72ebb4f3bd1c"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "3"], "=", 
    RowBox[{"I", " ", "cos\[Theta]"}]}], TraditionalForm]],ExpressionUUID->
  "d4589dd1-6b20-48d2-aa91-caa086ad03e9"]
}], "Text",
 CellChangeTimes->{{3.814500492715917*^9, 
  3.814500524869071*^9}},ExpressionUUID->"caacac1e-4342-41a7-993c-\
6f58c7780bd8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy Formulas", "Section",
 CellChangeTimes->{{3.8126838831826563`*^9, 
  3.8126838856123447`*^9}},ExpressionUUID->"18da5175-1db2-4f96-b391-\
0e351d320ff9"],

Cell["The Cartesian expressions", "Text",
 CellChangeTimes->{{3.812756271249497*^9, 
  3.812756280171054*^9}},ExpressionUUID->"7a6e64d9-5f9f-4fe2-aa0b-\
fcfcb1c79b3f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"j", "=", 
   RowBox[{"13", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A1Fit", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", "72"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A2Fit", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", "15"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A3Fit", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", "7"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IF", "[", "X_", "]"}], ":=", "X"}], ";"}]}], "Input",
 CellChangeTimes->{{3.81269262552077*^9, 3.812692877696088*^9}, {
   3.812694614727515*^9, 3.812694652404469*^9}, {3.8126984765955133`*^9, 
   3.812698496799975*^9}, {3.8126993153086777`*^9, 3.8126993397448397`*^9}, 
   3.812699382682349*^9, {3.8127562158943443`*^9, 3.812756231380958*^9}, {
   3.812769703845343*^9, 3.812769743018598*^9}, {3.812844812910515*^9, 
   3.812844814942504*^9}, {3.8128448559330387`*^9, 3.812844856848776*^9}, {
   3.812857497609291*^9, 3.81285750118513*^9}, {3.8128576002903852`*^9, 
   3.812857605837616*^9}, 3.814496722722821*^9, {3.814497914489221*^9, 
   3.814497918966181*^9}, {3.814505219300243*^9, 3.8145052265760736`*^9}, {
   3.814510398552734*^9, 3.814510403040501*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"b3e77835-2336-4d58-a1a2-819a86bed0b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical data (TSD energies)", "Section",
 CellChangeTimes->{{3.814500631620784*^9, 
  3.814500644302622*^9}},ExpressionUUID->"b19c4bc5-f039-48c6-b610-\
07317274f2e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"e0", "=", "1.7399"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"8.5", "+", 
      RowBox[{"2", "i"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "20"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"13.5", "+", 
      RowBox[{"2", "i"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "16"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"16.5", "+", 
      RowBox[{"2", "i"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "13"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spin4", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"23.5", "+", 
       RowBox[{"2", "i"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "9"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"excitation", "  ", "energies"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsd1", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.230329", ",", "0.516162", ",", "0.857522", ",", "1.25441", ",", 
     "1.70683", ",", "2.21478", ",", "2.77826", ",", "3.39726", ",", 
     "4.07178", ",", "4.80183", ",", "5.5874", ",", "6.42849", ",", "7.3251", 
     ",", "8.27724", ",", "9.28491", ",", "10.3481", ",", "11.4668", ",", 
     "12.6411", ",", "13.8708", ",", "15.1561", ",", "16.497"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tsd2", "=", 
   RowBox[{"{", 
    RowBox[{
    "1.34903", ",", "1.77368", ",", "2.25387", ",", "2.78958", ",", "3.38082",
      ",", "4.02758", ",", "4.72986", ",", "5.48767", ",", "6.301", ",", 
     "7.16986", ",", "8.09423", ",", "9.07413", ",", "10.1096", ",", 
     "11.2005", ",", "12.347", ",", "13.549", ",", "14.8065"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tsd3", "=", 
   RowBox[{"{", 
    RowBox[{
    "2.04238", ",", "2.57396", ",", "3.15888", ",", "3.7974", ",", "4.48976", 
     ",", "5.23613", ",", "6.0367", ",", "6.89161", ",", "7.80099", ",", 
     "8.76495", ",", "9.7836", ",", "10.857", ",", "11.9853", ",", 
     "13.1685"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tsd4", "=", 
    RowBox[{"{", 
     RowBox[{
     "4.32758", ",", "5.02986", ",", "5.78767", ",", "6.601", ",", "7.46986", 
      ",", "8.39423", ",", "9.37413", ",", "10.4096", ",", "11.5005", ",", 
      "12.647"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"absolute", " ", "energies"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsd1Abs", "=", 
   RowBox[{"tsd1", "+", "e0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsd2Abs", "=", 
   RowBox[{"tsd2", "+", "e0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsd3Abs", "=", 
   RowBox[{"tsd3", "+", "e0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsd4Abs", "=", 
   RowBox[{"tsd4", "+", "e0"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8145006457867527`*^9, 3.8145007319624043`*^9}, {
   3.814500766928255*^9, 3.814500769098052*^9}, {3.8145008087435627`*^9, 
   3.814501039573759*^9}, 3.814501354102684*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"bfe3d183-a904-4443-97ab-8f3d1af46271"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy function in Cartesian coordinates", "Section",
 CellChangeTimes->{{3.814505076004715*^9, 
  3.814505087940906*^9}},ExpressionUUID->"5e900978-4933-419f-92be-\
d201aa87e55b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox["1", 
      RowBox[{"2", "I"}]]}], ")"}], "A1", "*", 
   SubsuperscriptBox["x", "1", "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox["1", 
      RowBox[{"2", "I"}]]}], ")"}], "A2", "*", 
   SubsuperscriptBox["x", "2", "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox["1", 
         RowBox[{"2", "I"}]]}], ")"}], "A3"}], "+", 
     RowBox[{"A1", "*", 
      FractionBox["j", "I"]}]}], ")"}], 
   SubsuperscriptBox["x", "3", "2"]}], "+", 
  RowBox[{
   FractionBox["I", "2"], 
   RowBox[{"(", 
    RowBox[{"A1", "+", "A2"}], ")"}]}], "+", 
  RowBox[{"A3", "*", 
   SuperscriptBox["I", "2"]}], "+", 
  RowBox[{
   FractionBox["j", "2"], 
   RowBox[{"(", 
    RowBox[{"A2", "+", "A3"}], ")"}]}], "+", 
  RowBox[{"A1", "*", 
   SuperscriptBox["j", "2"]}], "-", 
  RowBox[{"I", 
   RowBox[{"(", 
    RowBox[{"I", "-", 
     FractionBox["1", "2"]}], ")"}], "A3"}], "-", 
  RowBox[{"2", "*", "A1", "*", "I", "*", "j"}]}]], "Text",
 CellChangeTimes->{{3.814505091903092*^9, 3.814505205785277*^9}, {
  3.81450611495588*^9, 
  3.814506195402433*^9}},ExpressionUUID->"80aeb341-b33d-472e-9db6-\
19d77e67b931"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3D-Figures", "Section",
 CellChangeTimes->{{3.8127562561187162`*^9, 3.81275626105748*^9}, {
  3.814500626222344*^9, 
  3.814500629629621*^9}},ExpressionUUID->"c839bee7-9b80-4d0d-a208-\
06bb3261d7ac"],

Cell[CellGroupData[{

Cell["Determine the scaling for the ellipsoid dynamically", "Subsection",
 CellChangeTimes->{{3.8145321385635977`*^9, 
  3.814532147339115*^9}},ExpressionUUID->"7f85f93e-d803-4bb9-bcd3-\
0dc6ea0a2b4d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"scaleEvolution", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spin1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "2.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spin1", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "1.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spin1", "[", 
        RowBox[{"[", "8", "]"}], "]"}], ",", "1.3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spin1", "[", 
        RowBox[{"[", "14", "]"}], "]"}], ",", "1.2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spin1", "[", 
        RowBox[{"[", "21", "]"}], "]"}], ",", "1.1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fit", "=", 
   RowBox[{"FindFit", "[", 
    RowBox[{"scaleEvolution", ",", 
     RowBox[{
      RowBox[{"a", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "b"}], "*", "x"}], "]"}]}], "+", "c"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "x", ",", 
     RowBox[{"Method", "\[Rule]", "NMinimize"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"scaleEvolution", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", " ", "Medium"}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "b"}], "*", "x"}], "]"}]}], "+", "c"}], ")"}], "/.", 
      "fit"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"spin1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"spin1", "[", 
        RowBox[{"[", 
         RowBox[{"Length", "[", "spin1", "]"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", "Thick"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"PlotRange", "->", "Full"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.814516888900058*^9, 3.8145169188812428`*^9}, {
  3.814517125248073*^9, 3.8145171254279947`*^9}, {3.81451719464123*^9, 
  3.814517195665498*^9}, {3.81451791362403*^9, 3.8145179449657173`*^9}, {
  3.814518138800165*^9, 3.8145181754184017`*^9}, {3.814518310154125*^9, 
  3.814518313447796*^9}, {3.8145183696904087`*^9, 3.814518373175455*^9}, {
  3.814518858369066*^9, 3.814518875086072*^9}, {3.8145189643370247`*^9, 
  3.814518968048715*^9}, {3.81453075522125*^9, 3.81453076926021*^9}, {
  3.814530958232395*^9, 3.814530996804809*^9}, {3.814531143883169*^9, 
  3.8145311540843687`*^9}, {3.814531791548855*^9, 3.814531832184965*^9}, {
  3.814532033838119*^9, 3.814532068801578*^9}, {3.814532168368579*^9, 
  3.814532168546275*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"97a3a041-004e-43ae-ad09-b38a6297d7bd"],

Cell[BoxData[
 GraphicsBox[{{{}, {
     {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], AbsoluteThickness[
      1.6], GeometricTransformationBox[InsetBox[
        FormBox[
         StyleBox[
          GraphicsBox[
           {EdgeForm[None], DiskBox[{0, 0}]}],
          StripOnInput->False,
          GraphicsBoxOptions->{DefaultBaseStyle->Directive[
            PointSize[0.012833333333333334`], 
            AbsoluteThickness[1.6], 
            RGBColor[1, 0, 0]]}],
         TraditionalForm], {0., 0.}, Automatic, Offset[10]], {{{8.5, 2.1}}, {{
       14.5, 1.5}}, {{22.5, 1.3}}, {{34.5, 1.2}}, {{48.5, 1.1}}}]}, {
      {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], AbsoluteThickness[
       1.6]}, {}}, {
      {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], AbsoluteThickness[
       1.6]}, {}}}, {{}, {}}}, {{{}, {}, 
     TagBox[
      {RGBColor[0, 0, 1], Thickness[Large], Opacity[1.], 
       LineBox[CompressedData["
1:eJwV02s01HkcBvBhyyrarNIutTVTcpmUkdRg+H4R898Yl+0kq0NrDEahzDHa
5LgkHa1o2kpTTjdSR1KmGQlbK6PdCOWS2ilEu9tJ0vabmZqRZf/74jnP+bx6
Xj0s4a7vEkwZDIaAzv9t5iZazGCw0Pf4Xn79LwxcZ95nQ5mxsME7YK5zIwPj
h/2sZJYs3J1zKvNsPQNbSpbNZtqysLiqmyq9xsCsMc0ErGVh15HK2/nnGfiu
MqI1V8TCLIWY13CAgU8XQfLMfRZWRyh5W0MZWD1l2zB9dDlqDJq7BZ0zoPdI
L+8KtMdqYdhWA2caNGEZDs3PV6Kc2hPMHpyCbXs7uLU7HVHVLuYZVJ+g0Kr1
2K4lznhoWjMSKZ8EqijhRHgdG8+Ycge8a41wI/XKsEmiC/50QG31xwMDNAr9
FQ0L1qAwrituyNwA0dyDzocvuqKp9t6rlqSP0HPbQyqv4aBJlcrDuusD3A2b
dsrKdMNLTxSiLYIPkJe8mxnrsxYPa9Te+kE9LPBy57Ft3LHi1dKOIYkeyGRw
TeGQO5bGhpsn2emhSlLv235rHaatzowpvqcDR8l9m/lHPLCOp/qwJFsH+jg3
/DNyPXI9t/ukgg5Omr8pveC6Act3j0ezZuug8NwkZ8K4Aa1zU0M+9WuB/zb6
4/LHXFzhVDYxcEkLT1tFJtFXPdFv6uz02xwt1Be1xTKlXlgbpQnWxWghcbb0
RXeoN45cEOwN9dVCvGRfvaUdD5VOXJmLvRZck1Z1h4zwcDrc5YRonhYeWrtY
SBt9kAhX2eV+JNB8bX+5S4EvDv/QrxD/RWCfCTu8MwaQyn+ntuonYJbmY7/B
DnFuz4WE+fcIZPRZdYTlIL7QrjervkUg5Ljl/udjiIGmE80tVwlsEihfcsL9
0H9kKPhNBQHXjjVJB5V+WCZ/ujDqNIGcit6psGX+uE0dM/71zwS0EhZvpMAf
o64+vkMVE+g9Ky/5+x9/HLIZ3f7rAQJPWpuKlJEBmMiUtHyfS6DtiqIqvykA
vxUcKazKIrB44lG/2mEjpjnI9jAzCcidy2u7ijdiCmewTSQhkNtSIg82bsSi
cQvVozQCgsVbqjpEgSiOm8u/tZOAX9rv275sD0RTC3WeczKBc0uE9p0eQaiI
zNOpEgnYqy+XhZYH4eiPQWO1IgKy1a3s3ukgvF9aHf9aSCBRO6unfQcfxcM2
UevjCAgVhHnoIR/Lx1J03dsJpOzfPLWph4/uC+vmtdOWblY9sezjYzjfgq2m
XaSXlsoG+Dgj+CylgfY1T+Onk4N87LvcufA8bePdmYFLb/hoejnGkE5b1mtZ
0vY5hdwtqVNf0T5dmSo+OIdC+/gzUmvalRndAZQFhbYc5XtL2jcXySYffEHh
Dt0hYkL7efQCMf14XPWocdF4LAHHl7YBoysovNnQ+6qFNkeVtfTiSgrnOF0p
babtVfjMmOBIWxzGvUk7xPFM3Ws2hTmZ/x6roS3ZyVz63o3C0v47KWW0s3n5
xhvu9H7bM+ejtAvnjfZneFC4eqDpdTFt+fXKYgOXwqFTjen5tCvyZiU1eVEY
lTzgmU27JiLBP5tHofXJ67P20FYt/+0bX18KB5UBvem072gdjDNAYUjE0YoU
2v8B5WNLlA==
        "]]},
      Annotation[#, "Charting`Private`Tag$3811#1"]& ]}, {}}},
  AspectRatio->1,
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{7.666666666666668, 1.0444444444444447`},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->Full,
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.814517226425838*^9, {3.81451791453415*^9, 3.814517945470222*^9}, {
   3.814518140600533*^9, 3.814518176106833*^9}, 3.814518313922937*^9, {
   3.814518370302621*^9, 3.8145183736362553`*^9}, {3.814518860174288*^9, 
   3.814518876304708*^9}, {3.814518965876423*^9, 3.8145189683513823`*^9}, 
   3.814530770263023*^9, {3.814530963754993*^9, 3.814530997523807*^9}, 
   3.814531157001362*^9, {3.8145318039922657`*^9, 3.814531832771247*^9}, {
   3.81453203947642*^9, 3.814532069477214*^9}, 3.814532170632298*^9, 
   3.81453329355261*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"2f8dc9a4-0c3b-46dd-b188-664f25ed04dd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"extra", " ", "padding", " ", "for", " ", "the", " ", 
    RowBox[{"sphere", "'"}], "s", " ", "radius"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pad", "=", "1.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LuEllipsoid", "[", 
      RowBox[{
      "I_", ",", "e_", ",", "A1_", ",", "A2_", ",", "A3_", ",", "axscale_"}], 
      "]"}], ":=", 
     RowBox[{"ContourPlot3D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox["1", 
             RowBox[{"2", "I"}]]}], ")"}], "A1", "*", 
          SuperscriptBox["x", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox["1", 
             RowBox[{"2", "I"}]]}], ")"}], "A2", "*", 
          SuperscriptBox["y", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox["1", 
                RowBox[{"2", "I"}]]}], ")"}], "A3"}], "+", 
            RowBox[{"A1", "*", 
             FractionBox["j", "I"]}]}], ")"}], 
          SuperscriptBox["z", "2"]}], "+", 
         RowBox[{
          FractionBox["I", "2"], 
          RowBox[{"(", 
           RowBox[{"A1", "+", "A2"}], ")"}]}], "+", 
         RowBox[{"A3", "*", 
          SuperscriptBox["I", "2"]}], "+", 
         RowBox[{
          FractionBox["j", "2"], 
          RowBox[{"(", 
           RowBox[{"A2", "+", "A3"}], ")"}]}], "+", 
         RowBox[{"A1", "*", 
          SuperscriptBox["j", "2"]}], "-", 
         RowBox[{"I", 
          RowBox[{"(", 
           RowBox[{"I", "-", 
            FractionBox["1", "2"]}], ")"}], "A3"}], "-", 
         RowBox[{"2", "*", "A1", "*", "I", "*", "j"}]}], "\[Equal]", "e"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"-", "2.1"}], "*", "I"}], ",", 
         RowBox[{"2.1", "*", "I"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{
          RowBox[{"-", "2.1"}], "*", "I"}], ",", 
         RowBox[{"2.1", "*", "I"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{
          RowBox[{"-", "2.1"}], "*", "I"}], ",", 
         RowBox[{"2.1", "*", "I"}]}], "}"}], ",", 
       RowBox[{"ContourStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"Opacity", "[", "0.5", "]"}]}], "}"}]}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sphere", "[", 
      RowBox[{"I_", ",", "e_", ",", "A1_", ",", "A2_", ",", "A3_"}], "]"}], ":=", 
     RowBox[{"ContourPlot3D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], "\[Equal]", 
        RowBox[{"I", "*", 
         RowBox[{"(", 
          RowBox[{"I", "+", "1"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"I", "+", "pad"}], ")"}]}], ",", 
         RowBox[{"(", 
          RowBox[{"I", "+", "pad"}], ")"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"I", "+", "pad"}], ")"}]}], ",", 
         RowBox[{"(", 
          RowBox[{"I", "+", "pad"}], ")"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"I", "+", "pad"}], ")"}]}], ",", 
         RowBox[{"(", 
          RowBox[{"I", "+", "pad"}], ")"}]}], "}"}], ",", 
       RowBox[{"MeshFunctions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                FractionBox["1", 
                 RowBox[{"2", "I"}]]}], ")"}], "A1", "*", 
              SuperscriptBox["x", "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                FractionBox["1", 
                 RowBox[{"2", "I"}]]}], ")"}], "A2", "*", 
              SuperscriptBox["y", "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   FractionBox["1", 
                    RowBox[{"2", "I"}]]}], ")"}], "A3"}], "+", 
                RowBox[{"A1", "*", 
                 FractionBox["j", "I"]}]}], ")"}], 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              FractionBox["I", "2"], 
              RowBox[{"(", 
               RowBox[{"A1", "+", "A2"}], ")"}]}], "+", 
             RowBox[{"A3", "*", 
              SuperscriptBox["I", "2"]}], "+", 
             RowBox[{
              FractionBox["j", "2"], 
              RowBox[{"(", 
               RowBox[{"A2", "+", "A3"}], ")"}]}], "+", 
             RowBox[{"A1", "*", 
              SuperscriptBox["j", "2"]}], "-", 
             RowBox[{"I", 
              RowBox[{"(", 
               RowBox[{"I", "-", 
                FractionBox["1", "2"]}], ")"}], "A3"}], "-", 
             RowBox[{"2", "*", "A1", "*", "I", "*", "j"}]}], "]"}]}], "]"}], 
         "}"}]}], ",", 
       RowBox[{"Mesh", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", "e", "}"}], "}"}]}], ",", 
       RowBox[{"ContourStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Specularity", "[", "0.2", "]"}], ",", 
          RowBox[{"Opacity", "[", "0.8", "]"}]}], "}"}]}], ",", 
       RowBox[{"MeshStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Yellow", ",", "Thick"}], "}"}]}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
       RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"axes", "[", 
      RowBox[{"I_", ",", "e_", ",", "axscale_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Black", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{"I", "+", "axscale"}]}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(x\), \(3\)]\)\>\"", ",", "20", ",", 
               "Bold", ",", "Italic", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}],
               "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", ".1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"I", "+", "axscale"}]}], "}"}]}], "]"}]}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "StringTemplate", "[", "\"\<I=`` \[HBar] ; E=`` MeV\>\"", "]"}], 
             "[", 
             RowBox[{"I", ",", "e"}], "]"}], ",", "Bold", ",", "Italic", ",", 
            "Black", ",", "18", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
           "]"}]}]}], "]"}], ",", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue", ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"I", "+", "axscale"}], ",", "0", ",", "0"}], "}"}]}], 
            "}"}], "]"}], ",", 
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(x\), \(1\)]\)\>\"", ",", "20", ",", 
              "Bold", ",", "Italic", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
             "]"}], ",", 
            RowBox[{"Scaled", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.1", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"I", "+", "axscale"}], ",", "0", ",", "0"}], "}"}]}], 
             "]"}]}], "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black", ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"I", "+", "axscale"}], ",", "0"}], "}"}]}], "}"}], "]"}
           ], ",", 
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(x\), \(2\)]\)\>\"", ",", "20", ",", 
              "Bold", ",", "Italic", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
             "]"}], ",", 
            RowBox[{"Scaled", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0.1", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"I", "+", "axscale"}], ",", "0"}], "}"}]}], "]"}]}], 
           "]"}]}], "}"}], "]"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.812692964034607*^9, 3.812693057071376*^9}, {
   3.812695580364354*^9, 3.812695686656618*^9}, {3.8126957786283083`*^9, 
   3.81269580597549*^9}, {3.8126961265911417`*^9, 3.812696131730332*^9}, {
   3.812696202013195*^9, 3.812696203990426*^9}, {3.8126974564854317`*^9, 
   3.812697456631464*^9}, {3.8126976850347347`*^9, 3.812697735775612*^9}, {
   3.812697810005719*^9, 3.8126978118027782`*^9}, {3.812697843418874*^9, 
   3.8126978444166527`*^9}, {3.812698533074078*^9, 3.8126985667685213`*^9}, {
   3.8126986408623877`*^9, 3.8126986826017227`*^9}, {3.812698717961195*^9, 
   3.8126987498904467`*^9}, {3.81269878311125*^9, 3.812698788927875*^9}, {
   3.81269883484433*^9, 3.8126988352466393`*^9}, 3.812698869648231*^9, {
   3.812699010967062*^9, 3.812699013121696*^9}, {3.812699909398364*^9, 
   3.812699910216991*^9}, {3.812699996126013*^9, 3.812699996202755*^9}, {
   3.812700370965967*^9, 3.81270041954214*^9}, {3.812700449998529*^9, 
   3.81270066205872*^9}, {3.812700885267571*^9, 3.812700889754343*^9}, {
   3.812701214261465*^9, 3.8127012148670883`*^9}, {3.812701584909175*^9, 
   3.812701589902364*^9}, {3.8127081174961042`*^9, 3.8127081645513353`*^9}, {
   3.812708445902359*^9, 3.812708448196374*^9}, {3.812708788563257*^9, 
   3.812708821773795*^9}, {3.8127090158444138`*^9, 3.81270901909286*^9}, {
   3.812709136531342*^9, 3.8127091758119183`*^9}, {3.812709460955592*^9, 
   3.812709491958061*^9}, {3.812709622757306*^9, 3.8127096399251966`*^9}, {
   3.8127097774263287`*^9, 3.812709778696949*^9}, {3.812709913972362*^9, 
   3.812709914322283*^9}, 3.812709985231954*^9, {3.812710048133597*^9, 
   3.8127100933592157`*^9}, {3.812710167939761*^9, 3.812710185364251*^9}, {
   3.812710269473756*^9, 3.812710352692026*^9}, {3.81271040968685*^9, 
   3.812710464383157*^9}, {3.812712253343573*^9, 3.8127122610420856`*^9}, {
   3.812712295852096*^9, 3.81271232256959*^9}, {3.8127564539321404`*^9, 
   3.8127565067481833`*^9}, {3.812756560997221*^9, 3.81275660948306*^9}, {
   3.812757174997282*^9, 3.8127571791721163`*^9}, {3.812757233251584*^9, 
   3.812757346888793*^9}, {3.812757404492413*^9, 3.812757445943367*^9}, {
   3.812757570428975*^9, 3.8127575722610407`*^9}, {3.812758362419346*^9, 
   3.812758365546811*^9}, {3.81275993898603*^9, 3.812759955029572*^9}, {
   3.81276000672915*^9, 3.8127600096081877`*^9}, {3.812767243422845*^9, 
   3.8127673350209417`*^9}, {3.812769152410511*^9, 3.812769155715597*^9}, {
   3.8127697575423117`*^9, 3.8127697642599077`*^9}, {3.812773979367178*^9, 
   3.812773989500229*^9}, {3.812844371888197*^9, 3.812844422870097*^9}, {
   3.812844692117298*^9, 3.812844696389452*^9}, {3.812845619216632*^9, 
   3.8128456348660107`*^9}, {3.812845920351124*^9, 3.8128459237798147`*^9}, {
   3.8128459817432003`*^9, 3.812845982257104*^9}, {3.812896543536467*^9, 
   3.812896543759288*^9}, {3.8144967339098787`*^9, 3.814496759255184*^9}, {
   3.814501403809577*^9, 3.814501560229702*^9}, {3.8145015942501183`*^9, 
   3.814501599148164*^9}, {3.8145018112342043`*^9, 3.814501930203659*^9}, {
   3.814506055982973*^9, 3.814506109174019*^9}, 3.814506321050365*^9, {
   3.8145063918151073`*^9, 3.814506395964272*^9}, {3.814506565969111*^9, 
   3.814506591695188*^9}, {3.814506710310091*^9, 3.814506710936757*^9}, {
   3.814507434271611*^9, 3.8145074343814383`*^9}, {3.814507481691093*^9, 
   3.814507566044682*^9}, {3.814507833881488*^9, 3.81450787577604*^9}, {
   3.81450996694335*^9, 3.814509966982974*^9}, 3.814516595951829*^9, {
   3.8145321826015377`*^9, 3.8145322008812523`*^9}, {3.814532252161425*^9, 
   3.814532281620346*^9}, {3.814532352685156*^9, 3.814532378140765*^9}, {
   3.814532518626485*^9, 3.8145325817865477`*^9}, {3.814532749401053*^9, 
   3.814532785672456*^9}, {3.814532962785026*^9, 3.814533008673585*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"f5291ad2-35ad-4e0f-affe-07553eefaaea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"axes", "[", 
      RowBox[{
       RowBox[{"spin1", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       RowBox[{"tsd1Abs", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", "axscale"}], "]"}], ",", 
     RowBox[{"sphere", "[", 
      RowBox[{
       RowBox[{"spin1", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       RowBox[{"tsd1Abs", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       RowBox[{"IF", "[", "A1Fit", "]"}], ",", 
       RowBox[{"IF", "[", "A2Fit", "]"}], ",", 
       RowBox[{"IF", "[", "A3Fit", "]"}]}], "]"}], ",", 
     RowBox[{"LuEllipsoid", "[", 
      RowBox[{
       RowBox[{"spin1", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       RowBox[{"tsd1Abs", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       RowBox[{"IF", "[", "A1Fit", "]"}], ",", 
       RowBox[{"IF", "[", "A2Fit", "]"}], ",", 
       RowBox[{"IF", "[", "A3Fit", "]"}], ",", "2.1"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"axscale", ",", "1", ",", "15", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "[", "tsd1Abs", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.814506229179007*^9, 3.8145062987364902`*^9}, {
   3.814506343988175*^9, 3.8145063476863737`*^9}, {3.814506406044478*^9, 
   3.814506415131921*^9}, {3.814506477832801*^9, 3.814506510747902*^9}, {
   3.8145065539053717`*^9, 3.814506559518021*^9}, {3.814506597399807*^9, 
   3.814506609154249*^9}, {3.81450663953233*^9, 3.814506652849704*^9}, {
   3.814507261239139*^9, 3.814507351183111*^9}, {3.814507580747826*^9, 
   3.814507617696368*^9}, {3.814509901891472*^9, 3.814509938981903*^9}, {
   3.8145099883389587`*^9, 3.814509990351159*^9}, {3.814510201118513*^9, 
   3.8145102360186453`*^9}, {3.814510451959403*^9, 3.8145104529238157`*^9}, 
   3.8145165619231653`*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"82965fe0-8c6d-4216-a95e-8dfe22d3969e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`axscale$$ = 13, $CellContext`k$$ = 1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`axscale$$], 1, 15, 1}, {
      Hold[$CellContext`k$$], 1, 21, 1}}, Typeset`size$$ = {
    409., {203., 207.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`axscale$5434$$ = 
    0, $CellContext`k$5435$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`axscale$$ = 1, $CellContext`k$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`axscale$$, $CellContext`axscale$5434$$, 0], 
        Hold[$CellContext`k$$, $CellContext`k$5435$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        $CellContext`axes[
         Part[$CellContext`spin1, $CellContext`k$$], 
         Part[$CellContext`tsd1Abs, $CellContext`k$$], \
$CellContext`axscale$$], 
        $CellContext`sphere[
         Part[$CellContext`spin1, $CellContext`k$$], 
         Part[$CellContext`tsd1Abs, $CellContext`k$$], 
         $CellContext`IF[$CellContext`A1Fit], 
         $CellContext`IF[$CellContext`A2Fit], 
         $CellContext`IF[$CellContext`A3Fit]], 
        $CellContext`LuEllipsoid[
         Part[$CellContext`spin1, $CellContext`k$$], 
         Part[$CellContext`tsd1Abs, $CellContext`k$$], 
         $CellContext`IF[$CellContext`A1Fit], 
         $CellContext`IF[$CellContext`A2Fit], 
         $CellContext`IF[$CellContext`A3Fit], 2.1]], 
      "Specifications" :> {{$CellContext`axscale$$, 1, 15, 
         1}, {$CellContext`k$$, 1, 21, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{454., {289., 295.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8145333313810863`*^9, 3.814533344792396*^9}},
 CellLabel->"Out[29]=",ExpressionUUID->"d38d60b1-ab69-49fd-87ce-e106899c3fe0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"LuEllipsoid", "[", 
     RowBox[{
      RowBox[{"spin1", "[", 
       RowBox[{"[", "p", "]"}], "]"}], ",", 
      RowBox[{"tsd1Abs", "[", 
       RowBox[{"[", "p", "]"}], "]"}], ",", 
      RowBox[{"IF", "[", "A1Fit", "]"}], ",", 
      RowBox[{"IF", "[", "A2Fit", "]"}], ",", 
      RowBox[{"IF", "[", "A3Fit", "]"}], ",", "k"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "10", ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p", ",", "1", ",", 
      RowBox[{"Length", "[", "tsd1Abs", "]"}], ",", "1"}], "}"}]}], "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.814508565728215*^9, 3.814508642417674*^9}, {
   3.814508688793211*^9, 3.8145087048796577`*^9}, 3.8145333251227903`*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"77afcea8-ebea-43f1-bd25-c964e9941c0b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{960, 1035},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 169, 3, 69, "Chapter",ExpressionUUID->"a6bfc515-495d-4114-8d0e-7b421182e749"],
Cell[CellGroupData[{
Cell[616, 22, 219, 5, 67, "Section",ExpressionUUID->"bf3c8d02-a663-405a-842a-00300e866e3c"],
Cell[CellGroupData[{
Cell[860, 31, 353, 7, 81, "Subsection",ExpressionUUID->"a38b2b5e-ff8f-407a-9bcf-5f30654c7777"],
Cell[1216, 40, 204, 3, 32, "Text",ExpressionUUID->"df1d78de-f74e-4048-a41d-ad5d5aa8c130"],
Cell[1423, 45, 2341, 53, 56, "Input",ExpressionUUID->"cd3bbdfa-b67a-4c5a-b996-bbef0c5a510e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3813, 104, 168, 3, 67, "Section",ExpressionUUID->"0d8adffc-e877-41d5-9c04-8dd308ab21cf"],
Cell[3984, 109, 787, 24, 74, "Text",ExpressionUUID->"caacac1e-4342-41a7-993c-6f58c7780bd8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4808, 138, 164, 3, 67, "Section",ExpressionUUID->"18da5175-1db2-4f96-b391-0e351d320ff9"],
Cell[4975, 143, 167, 3, 32, "Text",ExpressionUUID->"7a6e64d9-5f9f-4fe2-aa0b-fcfcb1c79b3f"],
Cell[5145, 148, 1425, 32, 115, "Input",ExpressionUUID->"b3e77835-2336-4d58-a1a2-819a86bed0b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6607, 185, 174, 3, 67, "Section",ExpressionUUID->"b19c4bc5-f039-48c6-b610-07317274f2e5"],
Cell[6784, 190, 3401, 95, 388, "Input",ExpressionUUID->"bfe3d183-a904-4443-97ab-8f3d1af46271"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10222, 290, 185, 3, 67, "Section",ExpressionUUID->"5e900978-4933-419f-92be-d201aa87e55b"],
Cell[10410, 295, 1308, 45, 90, "Text",ExpressionUUID->"80aeb341-b33d-472e-9db6-19d77e67b931"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11755, 345, 205, 4, 67, "Section",ExpressionUUID->"c839bee7-9b80-4d0d-a208-06bb3261d7ac"],
Cell[CellGroupData[{
Cell[11985, 353, 201, 3, 54, "Subsection",ExpressionUUID->"7f85f93e-d803-4bb9-bcd3-0dc6ea0a2b4d"],
Cell[CellGroupData[{
Cell[12211, 360, 3167, 82, 157, "Input",ExpressionUUID->"97a3a041-004e-43ae-ad09-b38a6297d7bd"],
Cell[15381, 444, 4232, 91, 377, "Output",ExpressionUUID->"2f8dc9a4-0c3b-46dd-b188-664f25ed04dd"]
}, Open  ]],
Cell[19628, 538, 14259, 335, 631, "Input",ExpressionUUID->"f5291ad2-35ad-4e0f-affe-07553eefaaea"],
Cell[CellGroupData[{
Cell[33912, 877, 2031, 45, 94, "Input",ExpressionUUID->"82965fe0-8c6d-4216-a95e-8dfe22d3969e"],
Cell[35946, 924, 2646, 54, 603, "Output",ExpressionUUID->"d38d60b1-ab69-49fd-87ce-e106899c3fe0"]
}, Open  ]],
Cell[38607, 981, 881, 21, 52, "Input",ExpressionUUID->"77afcea8-ebea-43f1-bd25-c964e9941c0b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

