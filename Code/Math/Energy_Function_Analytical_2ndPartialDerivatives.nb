(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26814,        760]
NotebookOptionsPosition[     23414,        692]
NotebookOutlinePosition[     23958,        710]
CellTagsIndexPosition[     23915,        707]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Energy Function - H(\[Theta],\[CurlyPhi])", "Chapter",
 CellChangeTimes->{{3.811674798318096*^9, 
  3.811674805168469*^9}},ExpressionUUID->"edc06709-c7c8-4837-a7c8-\
39aa95132636"],

Cell[CellGroupData[{

Cell["Analytical expressions of the 2nd order partial derivatives", "Section",
 CellChangeTimes->{{3.8116748080940037`*^9, 
  3.811674821007657*^9}},ExpressionUUID->"6663ea56-f47e-4dc8-b1a1-\
4ae90c4cadef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{"I_", ",", "\[Theta]_", ",", "\[CurlyPhi]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["I", "2"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["A", "1"], "+", 
       SubscriptBox["A", "2"]}], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["A", "3"], 
     SuperscriptBox["I", "2"]}], "+", 
    RowBox[{"I", 
     RowBox[{"(", 
      RowBox[{"I", "-", 
       FractionBox["1", "2"]}], ")"}], 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["A", "1"], 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], "2"]}], "+", 
       RowBox[{
        SubscriptBox["A", "2"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], "2"]}], "-", 
       SubscriptBox["A", "3"]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["j", "2"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["A", "2"], "+", 
       SubscriptBox["A", "3"]}], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["A", "1"], 
     SuperscriptBox["j", "2"]}], "-", 
    RowBox[{"2", 
     SubscriptBox["A", "1"], "I", "*", "j", "*", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
    RowBox[{"V", "*", 
     FractionBox[
      RowBox[{
       RowBox[{"2", "j"}], "-", "1"}], 
      RowBox[{"j", "+", "1"}]], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Gamma]", "+", 
       FractionBox["\[Pi]", "6"]}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8116748231556053`*^9, 3.811674981819051*^9}, {
  3.81168002792308*^9, 3.811680043413066*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"6fdbde25-4690-4c9e-8239-cb52c7c7d02a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"H", "[", 
     RowBox[{"\[ScriptCapitalI]", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "2"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8116802483151207`*^9, 3.81168028168305*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"480505aa-a645-4afc-9228-81f43377d0d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "j", " ", "\[ScriptCapitalI]", " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
   SubscriptBox["A", "1"]}], "+", 
  RowBox[{"\[ScriptCapitalI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "\[ScriptCapitalI]"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], "2"], " ", 
      SubscriptBox["A", "1"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], "2"], " ", 
      SubscriptBox["A", "2"]}], "-", 
     SubscriptBox["A", "3"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8116802522256413`*^9, 3.8116802826564837`*^9}, 
   3.8116808369683743`*^9, 3.811681679863903*^9, 3.811682211960284*^9, 
   3.8117373045245047`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"977a24ab-17b5-429d-9161-6cf8ac65d8ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"H", "[", 
     RowBox[{"\[ScriptCapitalI]", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[CurlyPhi]", ",", "2"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.811680289851231*^9, 3.811680302552264*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"c2920ff5-3da9-4257-a55e-0dea1ae9dbe2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ScriptCapitalI]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "\[ScriptCapitalI]"}]}], ")"}], " ", 
  RowBox[{"Cos", "[", 
   RowBox[{"2", " ", "\[CurlyPhi]"}], "]"}], " ", 
  SuperscriptBox[
   RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    SubscriptBox["A", "1"], "-", 
    SubscriptBox["A", "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.811680303759542*^9, 3.811680837003747*^9, 
  3.81168168177176*^9, 3.811682211996573*^9, 3.811737304567141*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"e5b492c6-6be3-4120-abae-ee922f494848"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"H", "[", 
     RowBox[{"\[ScriptCapitalI]", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
     "]"}], ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.811719358032899*^9, 3.8117193614990396`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"f9eac416-2de1-4e71-9f3c-83fa75fe4022"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", "\[ScriptCapitalI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "\[ScriptCapitalI]"}]}], ")"}], " ", 
  RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
  RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
  RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
  RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    SubscriptBox["A", "1"], "-", 
    SubscriptBox["A", "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.811719363779682*^9, 3.8117373046104393`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"99b50488-1b1e-40b4-9f34-833e4b3654bd"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[PartialD]", "2"], "H"}], 
    RowBox[{
     RowBox[{"\[PartialD]", "\[Theta]"}], 
     RowBox[{"\[PartialD]", "\[CurlyPhi]"}]}]], 
   SubscriptBox["|", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Theta]", "0"], ",", 
      SubscriptBox["\[CurlyPhi]", "0"]}], ")"}]]}], 
  TraditionalForm]],ExpressionUUID->"14111523-6e8f-46a1-a60a-c88671899a25"]], \
"Title",
 CellChangeTimes->{{3.811680081001203*^9, 3.811680116461588*^9}, {
  3.811681017293017*^9, 3.811681018459241*^9}, {3.811681052545211*^9, 
  3.81168105566195*^9}, {3.811719281633951*^9, 
  3.8117192880226393`*^9}},ExpressionUUID->"a2ae3a42-ebf2-4a97-8aea-\
277ffa772853"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pdH", "[", 
    RowBox[{"I_", ",", "p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"I", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], ",", 
       "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", "\[Rule]", "p"}], ",", 
      RowBox[{"\[CurlyPhi]", "\[Rule]", "q"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8117192959731083`*^9, 3.8117193467369223`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"13ae4c1a-cea1-475e-a963-1ced83aa6f35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[PartialD]", "H"}], 
    RowBox[{"\[PartialD]", "\[Theta]"}]], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[PartialD]", "2"], "H"}], 
     RowBox[{"\[PartialD]", 
      SuperscriptBox["\[Theta]", "2"]}]], 
    SubscriptBox["|", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Theta]", "0"], ",", 
       SubscriptBox["\[CurlyPhi]", "0"]}], ")"}]]}]}], 
  TraditionalForm]],ExpressionUUID->"424ae1be-f426-4830-897d-04fea87a20b9"]], \
"Title",
 CellChangeTimes->{{3.811680081001203*^9, 3.811680116461588*^9}, {
  3.811681017293017*^9, 3.811681018459241*^9}, {3.811681052545211*^9, 
  3.81168105566195*^9}},ExpressionUUID->"e9b32eb6-582c-49c6-97ea-\
3c26463e8fdb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pdTheta", "[", 
    RowBox[{"I_", ",", "p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"I", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], ",", 
       "\[Theta]"}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", "\[Rule]", "p"}], ",", 
      RowBox[{"\[CurlyPhi]", "\[Rule]", "q"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pd2Theta", "[", 
    RowBox[{"I_", ",", "p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"I", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "2"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", "\[Rule]", "p"}], ",", 
      RowBox[{"\[CurlyPhi]", "\[Rule]", "q"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.811680156064293*^9, 3.811680209388493*^9}, {
  3.8116809455263777`*^9, 3.811680953206356*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"295dd54f-35bd-4a65-a0d5-c800fd666849"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[PartialD]", "H"}], 
    RowBox[{"\[PartialD]", "\[CurlyPhi]"}]], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[PartialD]", "2"], "H"}], 
     RowBox[{"\[PartialD]", 
      SuperscriptBox["\[CurlyPhi]", "2"]}]], 
    SubscriptBox["|", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Theta]", "0"], ",", 
       SubscriptBox["\[CurlyPhi]", "0"]}], ")"}]]}]}], TraditionalForm]],
 FormatType->
  "TraditionalForm",ExpressionUUID->"ad7b1f54-5b65-4447-93c4-61546aa6c899"]], \
"Title",
 CellChangeTimes->{{3.811680081001203*^9, 3.8116801480747547`*^9}, {
  3.811681024151326*^9, 3.811681024465967*^9}, {3.811681058644491*^9, 
  3.811681064899434*^9}},ExpressionUUID->"58b99352-d5d3-46a4-bbcf-\
c7eceab0ee46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pdFi", "[", 
    RowBox[{"I_", ",", "p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"I", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], ",", 
       "\[CurlyPhi]"}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", "\[Rule]", "p"}], ",", 
      RowBox[{"\[CurlyPhi]", "\[Rule]", "q"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pd2Fi", "[", 
    RowBox[{"I_", ",", "p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"I", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[CurlyPhi]", ",", "2"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", "\[Rule]", "p"}], ",", 
      RowBox[{"\[CurlyPhi]", "\[Rule]", "q"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.811680216891101*^9, 3.811680226703045*^9}, {
  3.811680996746653*^9, 3.8116810059034433`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"e8214cae-e30e-47b1-a1e0-51aec39c3a3f"],

Cell[CellGroupData[{

Cell["Discriminant \[CapitalDelta]", "Section",
 CellChangeTimes->{{3.811680081001203*^9, 3.8116801480747547`*^9}, {
  3.811681024151326*^9, 3.811681024465967*^9}, {3.811681058644491*^9, 
  3.811681064899434*^9}, {3.8117255708357887`*^9, 
  3.811725585196446*^9}},ExpressionUUID->"f2ae63f7-4ca4-445d-8385-\
65d7f06606d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Discr", "[", 
    RowBox[{"I_", ",", "p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"pd2Theta", "[", 
        RowBox[{"I", ",", "p", ",", "q"}], "]"}], "*", 
       RowBox[{"pd2Fi", "[", 
        RowBox[{"I", ",", "p", ",", "q"}], "]"}]}], ")"}], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"pdH", "[", 
        RowBox[{"I", ",", "p", ",", "q"}], "]"}], ")"}], "2"]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.81172553618257*^9, 3.8117255494500513`*^9}, {
  3.8117255908740873`*^9, 3.811725655798506*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"bab9af5b-7b22-4392-a1e9-2b7501d67375"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Condition for ",
 StyleBox["critical",
  FontWeight->"Bold"]
}], "Section",
 CellChangeTimes->{{3.811735151749642*^9, 
  3.81173515675781*^9}},ExpressionUUID->"f8ae2616-a2eb-404a-b27b-\
7eaef99686a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IsCritical", "[", 
    RowBox[{"I_", ",", "p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pdFi", "[", 
        RowBox[{"I", ",", "p", ",", "q"}], "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{"pdTheta", "[", 
        RowBox[{"I", ",", "p", ",", "q"}], "]"}], "\[Equal]", "0"}]}], ",", 
     "1", ",", "0"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.811735171885748*^9, 3.811735224836355*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"a275050c-107f-41a1-8d0d-fd4eb04d1a7d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Condition for ",
 StyleBox["minimum",
  FontWeight->"Bold"]
}], "Section",
 CellChangeTimes->{{3.811735159293137*^9, 
  3.811735163881744*^9}},ExpressionUUID->"779aa2be-6fd4-469f-896f-\
9528635ad240"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IsMinimum", "[", 
    RowBox[{"I_", ",", "p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"IsCritical", "[", 
        RowBox[{"I", ",", "p", ",", "q"}], "]"}], "\[Equal]", "1"}], "&&", 
      RowBox[{
       RowBox[{"Discr", "[", 
        RowBox[{"I", ",", "p", ",", "q"}], "]"}], ">", "0"}], "&&", 
      RowBox[{
       RowBox[{"pd2Theta", "[", 
        RowBox[{"I", ",", "p", ",", "q"}], "]"}], ">", "0"}]}], ",", "1", ",",
      "0"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.811735233655422*^9, 3.811735290166551*^9}, {
  3.8117355246355457`*^9, 3.8117355248947983`*^9}, {3.8117356900308447`*^9, 
  3.8117356903963537`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"934ef1c6-7afa-4c0d-ba8c-1c2838cfac2d"]
}, Open  ]],

Cell["Numerical implementations", "Section",
 CellChangeTimes->{{3.8117257767840147`*^9, 
  3.8117257821657133`*^9}},ExpressionUUID->"552b3e81-c110-40ad-8140-\
24382d879d07"],

Cell[CellGroupData[{

Cell["Parameters", "Section",
 CellChangeTimes->{{3.811680764764673*^9, 
  3.8116807672167873`*^9}},ExpressionUUID->"47eaa7b5-31e0-4311-9b92-\
a2c52e8151aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["A", "1"], "=", 
   FractionBox["1", 
    RowBox[{"2", "*", "20"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["A", "2"], "=", 
   FractionBox["1", 
    RowBox[{"2", "*", "70"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["A", "3"], "=", 
   FractionBox["1", 
    RowBox[{"2", "*", "53"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "6.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin1", "=", "12.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin2", "=", "12.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin3", "=", "12.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin4", "=", "12.5"}], ";"}]}], "Input",
 CellChangeTimes->{{3.811680768301621*^9, 3.811680802737108*^9}, {
  3.811728460170023*^9, 3.811728465535659*^9}, {3.8117367266804733`*^9, 
  3.811736738943145*^9}, {3.811737291078524*^9, 3.811737299123193*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"b239d018-de57-4f8b-8cee-d95917ccb2bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Implement list with derivatives and validity for critical/minimal point\
\>", "Section",
 CellChangeTimes->{{3.8117319810410967`*^9, 
  3.811732005414504*^9}},ExpressionUUID->"4bec8a18-a670-414f-a83e-\
1424e67d80b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lister", "[", 
    RowBox[{"I_", ",", "p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", "*", 
      RowBox[{"180", "/", "\[Pi]"}]}], ",", 
     RowBox[{"q", "*", 
      RowBox[{"180", "/", "\[Pi]"}]}], ",", 
     RowBox[{"pdTheta", "[", 
      RowBox[{"I", ",", "p", ",", "q"}], "]"}], ",", 
     RowBox[{"pdFi", "[", 
      RowBox[{"I", ",", "p", ",", "q"}], "]"}], ",", 
     RowBox[{"pd2Theta", "[", 
      RowBox[{"I", ",", "p", ",", "q"}], "]"}], ",", 
     RowBox[{"pd2Fi", "[", 
      RowBox[{"I", ",", "p", ",", "q"}], "]"}], ",", 
     RowBox[{"Discr", "[", 
      RowBox[{"I", ",", "p", ",", "q"}], "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"IsCritical", "[", 
         RowBox[{"I", ",", "p", ",", "q"}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<YES\>\"", ",", "Blue", ",", " ", "Bold", ",", " ", "Italic"}], 
        "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<NO\>\"", ",", "Red", ",", " ", "Bold"}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"IsMinimum", "[", 
         RowBox[{"I", ",", "p", ",", "q"}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<YES\>\"", ",", "Blue", ",", " ", "Bold", ",", " ", "Italic"}], 
        "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<NO\>\"", ",", "Red", ",", " ", "Bold"}], "]"}]}], 
      "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mylist", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "StringTemplate", "[", 
           "\"\<I=``  |  \!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \
\(1\)]\)=`` \!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(2\)]\)=`` \
\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(3\)]\)=``\>\"", "]"}], "[", 
          RowBox[{"spin1", ",", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"2", 
              SubscriptBox["A", "1"]}], ")"}]}], ",", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"2", 
              SubscriptBox["A", "2"]}], ")"}]}], ",", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"2", 
              SubscriptBox["A", "3"]}], ")"}]}]}], "]"}], ",", "Bold", ",", 
         "22", ",", "Black"}], "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\[Theta]\>\"", ",", "Bold", ",", "22", ",", "Black"}], 
        "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\[CurlyPhi]\>\"", ",", "Bold", ",", "22", ",", "Black"}],
         "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\!\(\*FractionBox[\(\[PartialD]H\), \(\[PartialD]\[Theta]\)]\)\>\
\"", ",", "Bold", ",", "22", ",", "Black"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\!\(\*FractionBox[\(\[PartialD]H\), \
\(\[PartialD]\[CurlyPhi]\)]\)\>\"", ",", "Bold", ",", "22", ",", "Black"}], 
        "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\!\(\*FractionBox[\(\*SuperscriptBox[\(\[PartialD]\), \(2\)]H\), \
\(\[PartialD]\*SuperscriptBox[\(\[Theta]\), \(2\)]\)]\)\>\"", ",", "Bold", 
         ",", "22", ",", "Black"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\!\(\*FractionBox[\(\*SuperscriptBox[\(\[PartialD]\), \(2\)]H\), \
\(\[PartialD]\*SuperscriptBox[\(\[CurlyPhi]\), \(2\)]\)]\)\>\"", ",", "Bold", 
         ",", "22", ",", "Black"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\[CapitalDelta]\>\"", ",", "Bold", ",", "22", ",", "Black"}], 
        "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Critical\>\"", ",", "Bold", ",", "22", ",", "Black"}], 
        "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Minimum\>\"", ",", "Bold", ",", "22", ",", "Black"}], 
        "]"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"mylist", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"lister", "[", 
          RowBox[{"12.5", ",", 
           RowBox[{"p", "*", 
            RowBox[{"\[Pi]", "/", "180"}]}], ",", 
           RowBox[{"q", "*", 
            RowBox[{"\[Pi]", "/", "180"}]}]}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "9"}], "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"p", ",", "0", ",", "180", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q", ",", "0", ",", "360", ",", "10"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.811728434523472*^9, 3.8117284686967154`*^9}, {
  3.811728512238192*^9, 3.811728606107664*^9}, {3.811729924721175*^9, 
  3.8117299387133207`*^9}, {3.811731372114503*^9, 3.811731375837236*^9}, {
  3.8117315697929287`*^9, 3.811731787205535*^9}, {3.811731819450221*^9, 
  3.811731879641592*^9}, {3.811735361485242*^9, 3.811735457391275*^9}, {
  3.8117359998857393`*^9, 3.811736055227462*^9}, {3.81173609690832*^9, 
  3.8117361080001593`*^9}, {3.811736154119451*^9, 3.811736155904311*^9}, {
  3.8117367042020473`*^9, 3.811736828363523*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"c0fea981-3bc2-48ee-bdb2-974a2668d084"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\</Users/basavyr/Library/Mobile \
Documents/com~apple~CloudDocs/Work/Pipeline/DFT/163Lu-New-TSD4-Formalism/\
Resources/Output_Data/Energy_Function/partial_derivatives.pdf\>\"", ",", 
    RowBox[{"Grid", "[", 
     RowBox[{"mylist", ",", 
      RowBox[{"Frame", "\[Rule]", "All"}], ",", 
      RowBox[{"ItemSize", "\[Rule]", "All"}], ",", 
      RowBox[{"Background", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"LightGray", ",", "LightGreen"}], "}"}], "}"}], ",", 
         RowBox[{"{", "Red", "}"}]}], "}"}]}]}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.811728473986682*^9, 3.811728484797079*^9}, {
  3.811728611408842*^9, 3.8117286122403383`*^9}, {3.811731796286132*^9, 
  3.811731805801196*^9}, {3.811732246758862*^9, 3.811732316812977*^9}, {
  3.811732371446467*^9, 3.8117323993771276`*^9}, {3.811735974278035*^9, 
  3.811735978879511*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"2433950e-3927-44e6-8e90-3817b250fa27"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1720, 1395},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "Applications", 
   "Mathematica.app", "Contents", "SystemFiles", "FrontEnd", "StyleSheets"}, 
  "Times_Basavyr_Unique.nb", CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 186, 3, 78, "Chapter",ExpressionUUID->"edc06709-c7c8-4837-a7c8-39aa95132636"],
Cell[CellGroupData[{
Cell[791, 29, 206, 3, 75, "Section",ExpressionUUID->"6663ea56-f47e-4dc8-b1a1-4ae90c4cadef"],
Cell[1000, 34, 1727, 54, 61, "Input",ExpressionUUID->"6fdbde25-4690-4c9e-8239-cb52c7c7d02a"],
Cell[CellGroupData[{
Cell[2752, 92, 425, 10, 38, "Input",ExpressionUUID->"480505aa-a645-4afc-9228-81f43377d0d0"],
Cell[3180, 104, 996, 26, 54, "Output",ExpressionUUID->"977a24ab-17b5-429d-9161-6cf8ac65d8ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4213, 135, 427, 10, 38, "Input",ExpressionUUID->"c2920ff5-3da9-4257-a55e-0dea1ae9dbe2"],
Cell[4643, 147, 653, 17, 50, "Output",ExpressionUUID->"e5b492c6-6be3-4120-abae-ee922f494848"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5333, 169, 395, 8, 38, "Input",ExpressionUUID->"f9eac416-2de1-4e71-9f3c-83fa75fe4022"],
Cell[5731, 179, 645, 16, 48, "Output",ExpressionUUID->"99b50488-1b1e-40b4-9f34-833e4b3654bd"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6437, 202, 741, 20, 139, "Title",ExpressionUUID->"a2ae3a42-ebf2-4a97-8aea-277ffa772853"],
Cell[7181, 224, 656, 17, 38, "Input",ExpressionUUID->"13ae4c1a-cea1-475e-a963-1ced83aa6f35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7874, 246, 778, 22, 136, "Title",ExpressionUUID->"e9b32eb6-582c-49c6-97ea-3c26463e8fdb"],
Cell[8655, 270, 1235, 35, 63, "Input",ExpressionUUID->"295dd54f-35bd-4a65-a0d5-c800fd666849"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9927, 310, 819, 23, 143, "Title",ExpressionUUID->"58b99352-d5d3-46a4-bbcf-c7eceab0ee46"],
Cell[10749, 335, 1235, 35, 63, "Input",ExpressionUUID->"e8214cae-e30e-47b1-a1e0-51aec39c3a3f"],
Cell[CellGroupData[{
Cell[12009, 374, 321, 5, 75, "Section",ExpressionUUID->"f2ae63f7-4ca4-445d-8385-65d7f06606d3"],
Cell[12333, 381, 729, 20, 42, "Input",ExpressionUUID->"bab9af5b-7b22-4392-a1e9-2b7501d67375"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13099, 406, 218, 7, 75, "Section",ExpressionUUID->"f8ae2616-a2eb-404a-b27b-7eaef99686a6"],
Cell[13320, 415, 608, 16, 38, "Input",ExpressionUUID->"a275050c-107f-41a1-8d0d-fd4eb04d1a7d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13965, 436, 218, 7, 75, "Section",ExpressionUUID->"779aa2be-6fd4-469f-896f-9528635ad240"],
Cell[14186, 445, 827, 21, 38, "Input",ExpressionUUID->"934ef1c6-7afa-4c0d-ba8c-1c2838cfac2d"]
}, Open  ]],
Cell[15028, 469, 174, 3, 75, "Section",ExpressionUUID->"552b3e81-c110-40ad-8140-24382d879d07"],
Cell[CellGroupData[{
Cell[15227, 476, 157, 3, 56, "Section",ExpressionUUID->"47eaa7b5-31e0-4311-9b92-a2c52e8151aa"],
Cell[15387, 481, 1079, 29, 280, "Input",ExpressionUUID->"b239d018-de57-4f8b-8cee-d95917ccb2bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16503, 515, 226, 5, 75, "Section",ExpressionUUID->"4bec8a18-a670-414f-a83e-1424e67d80b8"],
Cell[16732, 522, 5571, 140, 218, "Input",ExpressionUUID->"c0fea981-3bc2-48ee-bdb2-974a2668d084"],
Cell[22306, 664, 1080, 24, 121, "Input",ExpressionUUID->"2433950e-3927-44e6-8e90-3817b250fa27"]
}, Open  ]]
}, Open  ]]
}
]
*)

